# 要件定義書：AI採用候補者評価アプリ（テキスト入力版）

## 1. 概要

### 1.1. 背景・目的

採用プロセスにおいて、多数の候補者情報を効率的かつ客観的な基準で評価・整理したいというニーズが存在する。本アプリは、採用担当者が定義した評価基準に基づき、AI（Google Gemini）を活用して候補者情報（Webアプリ内のテキストボックスに貼り付けられたテキスト）を自動評価し、その結果をダッシュボード形式で表示、さらに評価結果をファイルとしてエクスポートする機能を提供することで、採用業務の効率化と評価の標準化を支援することを目的とする。

### 1.2. システム概要

本システムはWebアプリケーションとして提供される。利用者はWebブラウザを通じて、Webアプリ内のテキストボックスに候補者の情報（職務経歴書やプロフィールなど）をコピー＆ペーストし、「解析」ボタンを押す。バックエンドAPIは受け取ったテキストを解析後、Google Gemini APIと連携して事前に定義されたプロンプトに基づき候補者を評価する。評価結果（AIによる評価記号・理由、及びシステムが計算したマッチ度スコア）はフロントエンドに返却され、ダッシュボードに表示される。利用者は表示された評価結果をCSVまたはMarkdown形式でエクスポートできる。
**重要な制約として、本システムは候補者情報や評価結果を永続的にデータベースに保存しない。**評価結果は評価実行後にフロントエンドが一時的に保持し、エクスポート時に再度バックエンドへ送信される。（単一候補者処理の場合、フロントは直近の結果を保持するか、実行のたびに結果を累積していくか選択可能）

### 1.3. スコープ

*   **対象範囲（IN SCOPE）**
    *   候補者情報をテキストボックスに入力・貼り付ける機能
    *   入力されたテキスト内容の解析（評価に必要な情報の抽出を試みる）
    *   Google Gemini APIとの連携による候補者評価（定義済みプロンプトに基づく）
    *   Geminiの評価結果（記号・理由）に基づくマッチ度スコアの計算機能
    *   評価結果（候補者識別子※、AI評価内容、計算スコア、所見）の構造化データ生成 (※識別子はAIに生成させるか、入力テキストから抽出を試みる)
    *   評価結果のWebダッシュボード（フロントエンド）への表示機能（直近または累積した結果）
    *   フロントエンドで保持している評価結果のCSV形式でのエクスポート機能
    *   フロントエンドで保持している評価結果のMarkdown形式でのエクスポート機能
    *   基本的なエラーハンドリング（テキスト未入力、APIエラー等）
*   **対象範囲外（OUT OF SCOPE）**
    *   ユーザーアカウント管理、ログイン認証機能
    *   候補者情報および評価結果の永続的なデータベース保存機能
    *   評価基準（プロンプト）の動的な編集・管理機能（初期はコード/設定ファイルに定義）
    *   過去の評価履歴の参照機能（DB不使用のため）
    *   ファイルからの直接インポート機能
    *   高度な分析機能（候補者間の比較、統計表示など）
    *   外部ATS（採用管理システム）との連携
    *   一度に複数の候補者情報を区切って入力・評価する機能（初期スコープ外）

### 1.4. 用語定義

| 用語                 | 定義                                                                                                                               |
| :------------------- | :--------------------------------------------------------------------------------------------------------------------------------- |
| 候補者情報           | 氏名、年齢、経歴、スキル、希望条件など、評価に必要な応募者の情報。Webアプリのテキストボックスに入力されるテキスト形式で提供される。        |
| 評価基準（プロンプト） | ユーザー提供の「採用条件マッチ度計算プロンプト」。必須条件、優遇条件、その他評価ポイント、重み付け、評価ステップ、ガイドライン、出力形式を含む。 |
| Gemini API         | Googleが提供する生成AIサービスのAPI。本システムでは候補者評価に使用する。                                                              |
| AI評価               | Gemini APIが評価基準に基づき、候補者情報の各項目に対して行う評価（記号：◎〇△×、理由付け）。                                                     |
| マッチ度スコア       | AI評価の記号を数値化（◎=1.0, 〇=0.7, △=0.3, ×=0.0）し、評価基準の重み付けに従ってバックエンドで計算される総合的な適合度（%）。            |
| 評価結果             | 一人の候補者に対する評価プロセス全体の出力。候補者識別子、AI評価（記号・理由）、計算されたマッチ度スコア、AIによる所見を含む構造化データ。     |
| ダッシュボード         | 評価結果を一覧および詳細形式で表示するWebインターフェース（フロントエンド）。評価結果は一時的に保持される。                                       |
| CSVファイル          | Comma-Separated Values形式のファイル。評価結果のエクスポートに使用。                                                               |
| Markdownファイル     | 軽量マークアップ言語形式のファイル。評価結果のエクスポートに使用。                                                               |
| API                  | Application Programming Interface。本システムではフロントエンドとバックエンド間の通信、及びバックエンドとGemini API間の通信を指す。          |

### 1.5. 参考文献

*   Candidate Evaluator API定義書 (OpenAPI YAML) - `api_definition.yaml` （別途作成したファイル）
*   採用条件マッチ度計算プロンプト - ユーザー提供資料

## 2. システム要件

### 2.1. 機能要件

| ID    | 要件名                     | 詳細                                                                                                                                                                                                                                                           | 優先度 |
| :---- | :------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :----- |
| FR-01 | 候補者情報テキスト入力   | 利用者はWebインターフェース上のテキストボックスに、評価したい候補者の情報（職務経歴書など）をコピー＆ペースト、または直接入力できる。                                                                                                                                     | 高     |
| FR-02 | 解析実行トリガー       | 利用者はテキスト入力後、「解析」ボタンをクリックすることで評価プロセスを開始できる。テキストボックスが空の場合はボタンを無効化するか、クリック時にエラーを表示する。                                                                                                                 | 高     |
| FR-03 | テキスト内容解析・整形 | バックエンドは受け取ったテキストデータを解析（可能であれば候補者名を抽出、不要な空白削除など整形）し、Gemini APIへの入力に適した形式にする。（初期は入力テキスト全体をそのまま利用することも可）                                                                           | 高     |
| FR-04 | Gemini API連携           | バックエンドは整形された候補者情報テキストと定義済み評価基準（プロンプト）を整形し、Google Gemini APIに評価リクエストを送信する。                                                                                                                            | 高     |
| FR-05 | AI評価結果取得・解析     | バックエンドはGemini APIからの応答（期待されるJSON形式の評価結果：各項目の記号・理由、所見）を取得し、解析する。Geminiに候補者識別子（氏名など）の抽出も依頼する。                                                                                              | 高     |
| FR-06 | マッチ度スコア計算       | バックエンドはGemini APIから得られた評価記号（◎〇△×）を定義されたスコア（1.0, 0.7, 0.3, 0.0）に変換し、評価基準の重み付けルールに従って必須条件・優遇条件・その他の各カテゴリのスコアと総合マッチ度（%）を計算する。                                                              | 高     |
| FR-07 | 評価結果生成             | バックエンドは、候補者識別子（AI抽出 or デフォルト値）、Geminiによる評価（記号・理由）、計算されたスコア、Geminiによる所見、入力された原文テキスト（オプション）をまとめた構造化データ（JSONオブジェクト）を生成し、フロントエンドに返す。 (単一候補者結果)       | 高     |
| FR-08 | ダッシュボード表示         | フロントエンドは受け取った単一の評価結果をダッシュボードに表示する。表示方法は、以前の結果に追加していく形式か、常に最新の結果で上書きする形式かを選択可能（初期は上書きがシンプル）。最低限、候補者識別子と総合マッチ度、詳細評価を表示する。                                 | 高     |
| FR-10 | 評価結果一時保持         | フロントエンドは`/evaluate` APIから受け取った評価結果データ（単一または累積）を、ユーザーがページを離れるかブラウザを閉じるまで一時的に保持する。                                                                                                                            | 高     |
| FR-11 | エクスポート形式選択     | 利用者はダッシュボード上で、エクスポートしたいファイル形式（CSVまたはMarkdown）を選択できる。                                                                                                                                                                            | 高     |
| FR-12 | 評価結果エクスポート     | 利用者がエクスポートを実行すると、フロントエンドは現在保持している評価結果データ（単一または複数）を指定された形式でバックエンドの`/export` APIに送信する。バックエンドは受け取ったデータに基づきCSVまたはMarkdownファイルを生成し、利用者にダウンロードさせる。                               | 高     |
| FR-13 | Gemini APIキー設定       | Gemini APIを利用するためのAPIキーは、バックエンドの安全な場所（環境変数や設定ファイル）に設定される。フロントエンドには公開されない。                                                                                                                                         | 高     |
| FR-14 | エラーハンドリング         | テキスト未入力、Gemini API通信エラー、スコア計算エラーなどが発生した場合、適切なエラーメッセージをフロントエンドに表示する。                                                                                                                           | 高     |

### 2.2. 非機能要件

| ID    | 要件分類     | 詳細                                                                                                                                                                                                                         |
| :---- | :----------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| NFR-01 | パフォーマンス | 入力されたテキスト量やGemini APIの応答速度に依存するが、一般的な職務経歴書程度のテキスト量において、「解析」ボタンクリックから評価結果表示までの応答時間は数十秒以内を目指す。エクスポート処理は数秒以内に完了すること。       |
| NFR-02 | ユーザビリティ | - UIは直感的で、テキスト入力、解析実行、結果確認、エクスポートの操作が容易であること。<br>- 評価結果（特に記号、理由、スコア）は明確かつ見やすく表示されること。<br>- エラーメッセージは利用者が理解しやすい内容であること。          |
| NFR-03 | 信頼性       | - Gemini APIの一時的なエラーが発生した場合でも、システム全体が停止しないこと（リトライやエラー通知）。<br>- スコア計算のロジックは正確であること。                                                                   |
| NFR-04 | セキュリティ   | - Gemini APIキーは安全に管理され、外部に漏洩しないこと。<br>- フロントエンドとバックエンド間の通信はHTTPSで暗号化されること。<br>- 入力されたテキストデータは処理後にサーバー上に残存しないこと（ステートレス設計）。       |
| NFR-05 | 保守性       | - コードはモジュール化され、理解しやすく、修正が容易であること。<br>- 評価基準（プロンプト、重み付け）の変更は、バックエンドのコード修正によって対応可能であること。                                                               |
| NFR-06 | 拡張性       | （将来的な考慮）評価基準の動的管理、DB連携、ATS連携など、将来的な機能追加を考慮した基本的な設計（APIベース、疎結合）とすること。                                                                                               |
| NFR-07 | 運用性       | - アプリケーションのデプロイ、ログ監視が容易に行えること。                                                                                                                                                                 |

### 2.3. インターフェース要件

*   **ユーザーインターフェース:**
    *   Webブラウザベースのダッシュボード。
    *   候補者情報入力用のテキストエリア。
    *   「解析」ボタン。
    *   評価結果表示エリア（識別子、スコア、詳細評価）。
    *   エクスポート形式選択（ドロップダウン/ラジオボタンなど）。
    *   エクスポート実行ボタン。
    *   処理中のインジケーター、エラーメッセージ表示エリア。
*   **APIインターフェース:**
    *   フロントエンドとバックエンド間のAPIは、別途定義されたOpenAPI Specificationに従う。
        *   `/evaluate` (POST): 候補者テキストを受け取り、評価結果(JSONオブジェクト)を返す。
        *   `/export` (POST): 評価結果(JSON配列 - フロントが累積保持した場合)を受け取り、指定形式のファイルを返す。
*   **外部インターフェース:**
    *   Google Gemini API: バックエンドからHTTPSで接続。認証にはAPIキーを使用。

### 2.4. データ/ファイル形式要件

*   **入力データ:**
    *   フロントエンドからバックエンドへは、テキストエリアに入力されたプレーンテキスト。
*   **Gemini APIへの入力:** 評価対象候補者の情報を含むテキスト。
*   **Gemini APIからの期待出力:** API定義書の`GeminiEvaluationOutput`スキーマに準拠したJSON形式。加えて、候補者名（識別子）の抽出も試みる。
*   **バックエンドからフロントエンドへの出力:** API定義書の`EvaluationResult`スキーマに準拠したJSONオブジェクト（単一候補者の結果）。
*   **出力ファイル (CSV):**
    *   ヘッダー行を含む。
    *   各行が一人の候補者を表す。
    *   列には、候補者識別子、各評価項目の記号、各評価項目の理由、各カテゴリのスコア、総合マッチ度、所見などを含む。具体的な列構成は別途定義。
*   **出力ファイル (Markdown):**
    *   候補者ごとにセクションを設ける。
    *   各セクション内で、評価結果（記号、理由、スコア、所見）を見出しやリスト等で整形して記述する。具体的なフォーマットは別途定義。

### 2.5. 制約条件

*   AIエンジンとしてGoogle Gemini APIを使用する。
*   候補者情報、評価結果の永続的なデータベース保存は行わない。
*   評価基準（プロンプト）は初期リリース時点ではコード/設定ファイルに固定する。
*   Webアプリケーションとして開発する。

## 3. その他

*   **今後の検討事項:**
    *   評価基準（プロンプト）のUIからの編集機能
    *   評価結果のソート・フィルタリング機能
    *   プロンプトエンジニアリングによる評価精度向上の継続的な検討
    *   利用量に応じたGemini APIコストのモニタリング# 要件定義
